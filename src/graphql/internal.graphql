scalar ObjectId
scalar Date

#QUERY==========================================
type Query {
    GetMe: User!

    GetMyVehicles: [Vehicle!]!

    GetMyBankAccounts: [BankAccount!]!

    GetMyHostedTrips: [HostedTrip]!
    GetMyRequestedTrips: [RequestedTrip]!

    GetMySentHandshakes: [Handshake]!
    GetMyReceivedHandshakes: [Handshake]!

    GetMatchingRequestedTrips(hostedTripId: ObjectId!): [RequestedTripMatch!]!
}

type User {
    _id: ObjectId!
    isActive: Boolean!
    mobile: String!
    email: String!
    preferredName: String!
    roleId: ObjectId!
    secret: Secret!
    currentCoord: [Float!]
    rating: UserRating!
}

type Role {
    _id: ObjectId!
    name: String!
    permissions: [Permission!]!
}

type Permission {
    _id: ObjectId!
    moduleId: ObjectId!
    value: String!
}

type Secret {
    hash: String!
}

type Module {
    _id: ObjectId!
    name: String!
}

type UserRating{
    asHost: HostRating!
    asRequester: RequesterRating!
}

type HostRating {
    politeness: Float!,
    punctuality: Float!,
    driving: Float!,
    meetsCondition: Float!,
}

type RequesterRating {
    politeness: Float!,
    punctuality: Float!,
}

type HostedTrip {
    _id: ObjectId!
    hostId: ObjectId!
    route: Route!
    time: TripTime!
    vehicleId: ObjectId #If vehicleId==null, vehicle is temporary
    vehicle: Vehicle #Could be a temporary or saved
    seats: Int!
    billing: TripBilling!
}

type Route {
    from: String!
    to: String!
    polyLines: [String!]
    keyCoords: [[Float!]!]
}

type TripTime {
    schedule: Date!
    start: Date
    end: Date
}

type Vehicle {
    _id: ObjectId!
    isActive: Boolean!
    ownerId: ObjectId!
    name: String!
    number: String!
    model: String!
    features: VehicleFeatures!
    rating: VehicleRating!
}

type VehicleFeatures {
    ac: Boolean!
    luggage: Boolean!
}

type VehicleRating {
    cleanliness: Float!
    ac: Float!
}

type TripBilling {
    bankAccountId: ObjectId!
    priceFirstKm: Float!
    priceNextKm: Float!
}

type BankAccount {
    _id: ObjectId!
    isActive: Boolean!
    ownerId: ObjectId!
    name: String!
    bank: String!
    number: String!
    branch: String!
}

type RequestedTrip {
    _id: ObjectId!
    requesterId: ObjectId!
    route: Route!
    time: TripTime!
    seats: Int!
}

type Handshake {
    _id: ObjectId!
    senderId: ObjectId!
    recipientId: ObjectId!
    hostedTripId: ObjectId!
    requestedTripId: ObjectId!
    time: HandshakeTime!
    payment: Payment!
    rating: TripRating!
}

type HandshakeTime {
    sent: Date!
    accepted: Date #When there is a time, handshake is accepted by recipient
}

type Payment {
    amount: Float!
    time: Date #When there is a time, payment is done
}

type TripRating {
    host: HostRating!
    requester: RequesterRating!
    vehicle: VehicleRating!
}

type RequestedTripMatch {
    hostedTripId: ObjectId!
    requestedTripId: ObjectId!
    results: [TripMatchResult!]!
}

type TripMatchResult {
    hostedTripLength: Float!
    requestedTripLength: Float!
    intersectionLength: Float!
    hostedTripCoverage: Float!
    requestedTripCoverage: Float!
    intersectionPolyLine: String!
}

#MUTATION========================================
type Mutation {
    CreateUser(user: UserInput!): ObjectId!
    SignIn(mobile: String!, password: String!): String!

    CreateHostedTrip(hostedTrip: HostedTripInput!): ObjectId!
}

input UserInput {
    isActive: Boolean!
    mobile: String!
    roleId: ObjectId!
    rating: UserRating!
    roleId: ObjectId!
    email: String!
    secret: Secret!
    preferredName: String!
}

input HostedTripInput {
    route: RouteInput!
    time: TripTimeInput!
    vehicleId: ObjectId #If vehicle is null, then this must not
    vehicle: VehicleInput  #If vehicleId is null, then this must not
    seats: Int!
    billing: TripBillingInput!
}

input RouteInput {
    from: String!
    to: String!
    polyLines: [String!]
    keyCoords: [[Float!]!]
}

input TripTimeInput {
    schedule: Date!
}

input VehicleInput {
    isActive: Boolean!
    name: String!
    number: String!
    model: String!
    features: VehicleFeaturesInput!
}

input TripBillingInput {
    bankAccountId: ObjectId!
    priceFirstKm: Float!
    priceNextKm: Float!
}

input VehicleFeaturesInput {
    ac: Boolean!
    luggage: Boolean!
}